# SimpleTasks API

## Описание проекта
SimpleTasks — это RESTful API для управления задачами в компании. Система позволяет создавать, назначать и управлять задачами сотрудников, группировать их по статусам, а также фильтровать и сортировать данные.

## Используемые технологии
- **PHP 8.2+**
- **Laravel 12**
- **MariaDB**

## Установка и запуск
```bash
# Клонируем репозиторий
git clone https://github.com/dknz22/simpletasks.git
cd simpletasks

# Устанавливаем зависимости
composer install

# Создаем файл .env и настраиваем подключение к базе данных
cp .env.example .env

# Генерируем ключ приложения
php artisan key:generate

# Запускаем миграции и сидеры
php artisan migrate --seed

# Запускаем сервер
php artisan serve
```

## API Endpoints

### 1. Сотрудники (Employees)

| Метод | URL | Описание |
|--------|------------------|---------------------------|
| **GET** | `/api/employees` | Получить список сотрудников |
| **POST** | `/api/employees` | Создать нового сотрудника |
| **GET** | `/api/employees/{id}` | Получить информацию о сотруднике |
| **PUT** | `/api/employees/{id}` | Обновить данные сотрудника |
| **DELETE** | `/api/employees/{id}` | Удалить сотрудника |
| **POST** | `/api/employees/{id}/roles` | Обновить роли сотрудника |

#### Пример запроса для создания сотрудника:
```json
{
  "name": "Иван Иванов",
  "email": "ivan@example.com",
  "status": "active"
}
```

#### Возможные query-параметры для списка сотрудников:
| Параметр | Тип | Описание |
|----------|-----|-----------|
| `status` | string | Фильтр по статусу (`active`, `on_leave`) |
| `sort_by` | string | Поле сортировки (`id`, `name`, `email`, `status`) |
| `sort_order` | string | Порядок сортировки (`asc`, `desc`) |
| `page` | int | Страница пагинации |

---

### 2. Задачи (Tasks)

| Метод | URL | Описание |
|--------|------------------|---------------------------|
| **GET** | `/api/tasks` | Получить список задач |
| **POST** | `/api/tasks` | Создать новую задачу |
| **GET** | `/api/tasks/{id}` | Получить информацию о задаче |
| **PUT** | `/api/tasks/{id}` | Обновить данные задачи |
| **DELETE** | `/api/tasks/{id}` | Удалить задачу |
| **POST** | `/api/tasks/{id}/assign` | Назначить сотрудников на задачу |
| **GET** | `/api/tasks/grouped` | Получить задачи, сгруппированные по статусу |

#### Пример запроса для создания задачи:
```json
{
  "title": "Разработать API",
  "description": "Создать новый API для управления задачами",
  "status": "to_do"
}
```

#### Возможные query-параметры для списка задач:
| Параметр | Тип | Описание |
|----------|-----|-----------|
| `status` | string | Фильтр по статусу (`to_do`, `in_progress`, `done`) |
| `created_from` | date | Фильтр по дате создания (начиная с) |
| `created_to` | date | Фильтр по дате создания (до) |
| `sort_by` | string | Поле сортировки (`id`, `title`, `status`, `created_at`) |
| `sort_order` | string | Порядок сортировки (`asc`, `desc`) |
| `page` | int | Страница пагинации |

#### Пример запроса для назначения сотрудников на задачу:
```json
{
  "employee_ids": [1, 2, 3]
}
```

---

## Обработка ошибок
API возвращает стандартные HTTP-коды:
- `200 OK` — успешный запрос
- `201 Created` — успешное создание ресурса
- `400 Bad Request` — неверные параметры запроса
- `404 Not Found` — ресурс не найден
- `422 Unprocessable Entity` — ошибка валидации
- `429 Too Many Requests` — слишком много запросов
- `500 Internal Server Error` — внутренняя ошибка сервера

---

## Очереди и автоматические процессы
- Если задача не назначена ни одному сотруднику в течение **2 минут**, она **автоматически удаляется** (`DeleteUnassignedTask`).
- Если статус задачи изменяется на `in_progress` или `done`, сотрудники получают уведомление (`TaskStatusUpdated`).